# 4장. 처리율 제한 장치의 설계
- 처리율 제한 장치 (rate limiter) : 클라이언트 혹은 서비스가 보내는 **트래픽의 처리율을 제어**하기 위한 장치
    > ❓ circuit breaker 랑 차이점?
    - HTTP 를 예로 들면 이 장치는 `특정 기간` 내에 전송되는 `클라이언트 요청 횟수`를 제한함
    - **API 요청 횟수**게 클라이언트 또는 서비스가 보내는 트래픽 처리율을 제어하기 위한건데
왜 네트워크 트래픽을 분산시키는 로드밸런서가 아니라 api gateway 에서 처리율 제한을 수행하지?가 제한 장치에 **정의된 임계치를 넘어서면, 추가로 도달한 모든 호출은 처리가 중단**됨
- API 에 처리율 제한 장치를 두면 좋은 점
  - DoS 공격에 의한 자원 고갈 방지
  - 비용 절감
    - 우선순위가 높은 API에 더 많은 자원을 할당할 수 있음
  - 서버 과부하 
    - 봇에서 오는 트래픽이나 사용자의 잘못된 이용패턴으로 유발된 트래픽을 걸러내는 데 활용할 수 있음

## 1단계 : 문제 이해 및 설계 범위 확정
- 서버측 API를 위한 장치
- 다양한 형태의 제어규칙을 정의할 수 있는 유연한 시스템
  > ❓어떤 사례가 있을까?
- 대규모 요청 처리할 수 있어야 함
- 분산 환경에서 동작해야 함
- 한 서버에 대해 제어 규칙이 바뀔 수도 있다는 전제
- 독립된 서비스 or 애플리케이션 코드 포함할 것인가?
- 사용자의 요청이 걸러진 경우, 사용자에게 그 사실을 알려야 함

### 요구사항
- 낮은 응답시간
- 가능한 한 적은 메모리
- 분산형 처리율 제한 : 여러 서버나 프로세스에서 공유할 수 있어야 함
- 예외 처리
- 높은 결함 감내성 : 제한 장치에 장애가 생겨도 전체 시스템에 영향을 주어서는 안됨
